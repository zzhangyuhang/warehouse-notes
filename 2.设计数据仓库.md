#<数据仓库>读书笔记
##第三章:设计数据仓库
###从操作型数据开始
	1.创建数据仓库就是从操作环境中抽取数据然后将这些数据载入数据仓库.
	2.操作环境中产生的数据是未进行集成处理的,抽取后直接载入数据仓库是个严重的错误.
	3.数据缺乏集成的问题有
		(1)数据编码不一致
			例如:性别的编码不同,有的表用0/1表示,有的表用m/f表示.
				 数据单位不同,有的表是厘米,有的表示毫米.
		(2)字段予以未转换
			例如:同一个字段在四个应用中有四个不同的值,必要做正确的映射.
		(3)数据格式不统一
	4.经过抽取过程的数据还要注意时基变化的问题,这些数据务必加上时间元素.
###数据/过程模型与体系结构化环境
	1.过程模型仅仅适用于操作型环境
	2.数据模型既可用于操作型环境,又可用于数据仓库环境.
###数据模型
	1.企业数据模型在构造时没有考虑现有的操作型系统与数据仓库之间的差别.
	2.企业数据模型只关注原始数据.要建立现有独立的数据模型需要从企业模型开始.
	3.从企业数据模型到操作型数据模型:加入系统性能型因素.
	4.从企业数据模到数据仓库数据模型:
		(1)去除用于操作型环境的数据
		(2)添加时间元素
		(3)稳定性分析(根据数据属性是否变化进行分组)
	5.企业数据模型是操作型数据模型与数据仓库数据模型的共同起源.
###数据仓库的数据模型
	1.数据建模分为三个层次:高层建模 中间层建模 底层建模
	2.高层建模
		根据实体关系图(ER图)进行建模.
		例如:供应商 -> 订单 <-> 零件 -> 生产线
		<->:一对多  ->:一对一
	3.中间层建模
		* 对高层模型中标识出的每个主要主题域或实体,都要建立一个中间层模型.
		例如:上面ER图标识出来的四个主要主题域:供应商 订单 零件 生产线
		* 构建时很难一次构建成功,所以首先对某个主题进行扩充,其他部分保持不变.
		* 中间层数据模型的四个基本构造:
			(1)主要数据组:每个主要主题域只有一个主要数据分组.
			(2)二级数据分组:可以包含多个二级数据分组.
			(3)连接器:标识两个分组之间的关系,两个分组表间的连接数据.
			(4)数据的类型:用于描述数据组,分为超类和子类.左边为超类,右边为子类.
		例如:
			形式一:按照关系进行关系划分
			账号:余额 开户日期 ----- 贷款账号:限额 利息
			   |              |
		顾客----              --- 储蓄账号:存款 余额
			   |
			地址:街道 城市 国家
			形式二:共用数据作为超类,独有数据作为子类
			银行活动:账号 日期 金额 地点 出纳员  ----- 存款:票据 邮寄地址
			                                  |
			                                  --- 提款:余额核实 金额类型
			                                  |
			                                  --- ATM:ID 限额 时间
			                                  |
			                                  --- 出纳员:ID 流水号 库余额
			                                  
	4.物理数据模型
		* 物理数据模型是从中间层数据模型创建而来的.
		* 扩展中间层模型,使模型中包含关键字和物理特性.
		* 由一系列关系表组成.
		* 最后要做性能特性的优化.(粒度和分区以及关键之的选取)
		* 输出是一系列的表,每个表都包含关键字和属性(一般是时间属性)
###迭代式开发
	任何情况下,数据仓库都应当以迭代式开发进行建造.
	迭代式开发的意思是首先建造数据仓库的一部分,然后建造另一部分,如此反复.
###规范化/反向规范化
	* 常规输出是大量的表,每个表只包含少量数据.虽然规范,但是性能是个问题.
	* 程序每次访问一个表就会进行一次I/O,表多导致I/O剧增,性能下降.
	* 解决办法是合并一些表或者抑郁冗余数据达到节省I/O或者根据访问率划分表内容.
###元数据
	* 元数据是描述数据(结构和内容)的数据.
	* 元数据是数据仓库环境的饿一个重要组成部分.
	* 元数据与指向数据仓库内容的索引相似,处于数据仓库的上层,并且记录数据对象位置.
	* 参照数据可以显著减少数据仓库中的数据量.
	* 管理参照数据需要加入时间属性来保证参照数据的正确性.
###数据周期--时间间隔
	* 数据周期是指从操作型环境中的数据发生变化到这个变化反映到数据仓库中所用的时间.
	* 一般数据周期为24小时,没必要急于把这个变化转到数据仓库中去.
	* 时间间隔短,数据不稳定,所耗费投资和技术昂贵.
###数据仓库记录的触发
	1. 业务活动产生的事件
		随机的,例如一次销售 一次货物入库 一次电话 
	2. 时间产生的事件
		不是随机的,是规律性的时间推移标志.
###概要记录
	* 把操作型数据中许多不同的和详细的记录组合在一起形成的记录.
	* 一条概要记录以聚集的形式代表了需要调操作型记录.
	* 概要型记录相当于轻度的数据聚集.
	* 只要进行数据聚集就会丢失一些细节数据,但丢失细节数据不是坏事,只要保证丢失的细节对DSS人员是无关紧要的.
	* 避免丢失细节可以建立细节的备用层,这种备用层数据不经常使用,不容易被访问.
	* 根据相同的细节可以创造多个概要记录.
		例如:单个通话记录可以构造顾客概要记录 地区通信概要记录 线路分析概要记录.
###星型连接
	* 数据仓库中有一种不同意数据库规范化的设计方法叫多维方法.这种方法需要星型连接 事实表和维.
	* 多维方法只适用于数据集市,而不适用于数据仓库.
	* 数据集市很大程度上是根据需求来形成的,一旦需求已知,可以将数据集市建成一个最优的星型连接结构.
	* 数据仓库对弈任何一个需求集合而言,性能和便捷性都不是最优的.
	* 数据仓库是根据企业信息需求而非部门信息需求建立的.所以数据仓库建立不能使用星形连接.因为星型连接牺牲了其他群体的利益为代价来对一个群体实现最优.
	* 数据集市起始于数据模型,每个数据模型都有许多关联的简单实体组成,每个实体不是相互对等关系,需要自身单独处理.
	例如:
	  [销售商]-----        ----- [顾 客]
				  |       |        |
			  -----[产 品]------    |  
			  |                |   |
		[订 单]---------------[发  货]
	其中订单实体的载入量是远远高于其他实体的.
	* 用力啊管理载入数据集市中某个实体的大量数据的设计结构成为星型连接.
	例如:
	
		                         [ 订  单 ]
		                          |订单数据| 
	[销售商:销售ID,销售商数据]	-- |销售商ID|
	[顾客:顾客ID,顾客数据]  ----    | 顾客ID | 
	[发货:订单ID,订单数据]  ----	| 发单ID |
								  ---------    
		其中,订单表称为事实表,销售商 顾客 发货表为维度表.维度表的主键和订单表中相应的外键是对等的.一个星型连接可以用都多个维度.
	* 创建星型连接的好处是可以决策支持系统的处理优化数据. 
	* 一般星形连接中文本数据和数值数据是分开的,可以大大简化和调整访问和分析的数据.
	* 星形连接对于做决策用的数据市集来说是非常理想的.但难以创建和维护.
###数据仓库和数据集市
	* 数据仓库中的数据是粒度化的,数据集市中的数据是紧凑和综合的.
	* 数据必须周期性的从数据仓库移到数据集市.
	* 必须对数据仓库中的数据进行选择,访问,重组来能适合数据集市的需求.
	* 数据仓库可以根据各样的需求构建不同的数据集市.
	* 数据仓库不是处理需求而建造成的,而是根据企业需求而设计的.
##小结
	* 数据仓库设计始于数据模型.
	* 企业数据模型用于操作型环境设计,修改后的企业数据模型用于数据仓库.
	* 数据仓库构造是迭代的.
	* 数据仓库用粒度和分区以及访问率来完成对大量数据的管理.
	* 从操作型环境相数据仓库导入数据的时候要经过转换 重新格式化和集成的过程,同时还要加入时间属性对粒度级别进行调整.
	* 数据模型有三个层次:
		(1)高层:实体与企业需求的主题域有关.
		(2)中层:在高层基础上的细化.
		(3)低层:关联表.
	* 为了便于访问,在低层数据模型设计的时候需要轻度反向规范化处理(冗余数据)
	* 数据仓库记录包括:时间戳 关键字 直接数据 二级数据
	* 参照表的管理也要根据时间来完成.
	* 操作型环境数据导入数据仓库的时候一般有24小时的时间间隔.
	* 数据仓库事件触发条件:(1)业务事件 (2)时间推移产生事件
	* 概要记录是细节数据的复合表示.
	* 星形连接应用于数据集市,不适用于数据仓库.
	* 在星形连接多维方法中,数据库的设计是基于一个主题域中数据的出现次数和数据的访问方式进行的.